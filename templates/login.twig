<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dinero - Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { border-radius: 0 !important; }
    </style>
</head>
<body class="bg-gray-100 h-screen flex items-center justify-center">

    <div class="bg-white p-10 shadow-sm w-full max-w-sm border border-gray-200">
        <h1 class="text-4xl font-light text-center mb-12 tracking-[0.2em] text-primary">DINERO</h1>
       
        {% if error %}
            <div class="bg-red-50 text-red-600 text-sm p-4 mb-6 text-center border-l-4 border-red-500" role="alert">
                <p>{{ error }}</p>
            </div>
        {% endif %}

        <form id="pin-form" action="/login" method="POST" class="flex flex-col items-center">
            <!-- PIN Dots -->
            <div class="flex space-x-6 mb-12" id="pin-dots">
                <div class="w-3 h-3 border border-gray-300 transition-all duration-200"></div>
                <div class="w-3 h-3 border border-gray-300 transition-all duration-200"></div>
                <div class="w-3 h-3 border border-gray-300 transition-all duration-200"></div>
                <div class="w-3 h-3 border border-gray-300 transition-all duration-200"></div>
                <div class="w-3 h-3 border border-gray-300 transition-all duration-200"></div>
                <div class="w-3 h-3 border border-gray-300 transition-all duration-200"></div>
            </div>

            <input type="hidden" name="pin" id="pin-input">

            <!-- Keypad -->
            <div class="grid grid-cols-3 gap-4 w-full">
                {% for i in 1..9 %}
                    <button type="button" onclick="appendPin('{{ i }}')" class="keypad-btn">
                        {{ i }}
                    </button>
                {% endfor %}
                <button type="button" onclick="clearPin()" class="keypad-btn hover:!bg-red-50 hover:!text-red-500 hover:!border-red-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="square" stroke-linejoin="miter" stroke-width="1.5" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
                <button type="button" onclick="appendPin('0')" class="keypad-btn">
                    0
                </button>
                <button type="button" onclick="backspacePin()" class="keypad-btn hover:!bg-blue-50 hover:!text-primary hover:!border-blue-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="square" stroke-linejoin="miter" stroke-width="1.5" d="M12 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12l6.41-6.41L10.83 4H20a2 2 0 012 2v12a2 2 0 01-2 2H10.83l-1.42-1.59L3 12z" />
                    </svg>
                </button>
            </div>
        </form>
    </div>

    <style>
        body {
            background-color: #f9fafb;
            font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
        }
        .text-primary {
            color: #0B508C;
        }
        .keypad-btn {
            height: 4rem;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 300;
            color: #4b5563;
            background-color: white;
            border: 1px solid #e5e7eb;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        .keypad-btn:hover {
            background-color: #f3f4f6;
            color: #111827;
            border-color: #d1d5db;
        }
        /* Subtile touche de couleur au clic/active */
        .keypad-btn:active {
            background-color: #eff6ff;
            color: #0B508C;
            border-color: #0B508C;
            transform: translateY(1px);
        }
        .dot-filled {
            background-color: #0B508C;
            border-color: #0B508C;
            transform: scale(1.1);
        }
    </style>



    <script>
        let currentPin = '';
        const pinInput = document.getElementById('pin-input');
        const dots = document.querySelectorAll('#pin-dots div');

        function appendPin(digit) {
            if (currentPin.length < 6) {
                currentPin += digit;
                updateUI();
                if (currentPin.length === 6) {
                    setTimeout(() => {
                        document.getElementById('pin-form').submit();
                    }, 200);
                }
            }
        }

        function clearPin() {
            currentPin = '';
            updateUI();
        }

        function backspacePin() {
            currentPin = currentPin.slice(0, -1);
            updateUI();
        }

        function updateUI() {
            pinInput.value = currentPin; // Mise Ã  jour de la valeur pour le formulaire
            dots.forEach((dot, index) => {
                if (index < currentPin.length) {
                    dot.classList.add('dot-filled');
                } else {
                    dot.classList.remove('dot-filled');
                }
            });
        }


        // Physical keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.key >= '0' && e.key <= '9') {
                appendPin(e.key);
            } else if (e.key === 'Backspace') {
                backspacePin();
            } else if (e.key === 'Escape') {
                clearPin();
            }
        });
    </script>


</body>
</html>
